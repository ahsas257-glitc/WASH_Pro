/* design/css/liquid_glass.css */

/* =========================================================
   LIQUID GLASS PRO v3 — iOS/macOS Ultra
   - Frosted border glow
   - Glass reflection
   - Dynamic blur on scroll (var: --bt-scroll-k)
   - macOS window style
   ========================================================= */

/* -----------------------------
   1) Tokens — Base
------------------------------ */
:root{
  --lg-radius-xl: 24px;
  --lg-radius-lg: 18px;
  --lg-radius-md: 14px;

  /* Ultra blur (iOS-like) */
  --lg-blur-base: 28px;
  --lg-blur-boost: 18px; /* added via scroll */

  --lg-sat: 190%;
  --lg-bright: 1.05;

  --lg-shadow: 0 22px 80px rgba(0,0,0,0.30);
  --lg-shadow-soft: 0 14px 44px rgba(0,0,0,0.20);
  --lg-shadow-hover: 0 40px 140px rgba(0,0,0,0.42);

  --lg-focus: rgba(0,200,255,0.22);

  /* accents (RGB) */
  --a-cyan: 0,200,255;
  --a-orange: 255,150,0;
  --a-purple: 165,90,255;
  --a-green: 0,255,170;
  --a-red: 255,70,70;

  --lg-ease: cubic-bezier(.2,.8,.2,1);
}

/* -----------------------------
   2) Theme Tokens — Dark
------------------------------ */
html[data-theme="dark"]{
  --lg-txt: rgba(255,255,255,0.94);
  --lg-muted: rgba(255,255,255,0.72);

  --lg-border: rgba(255,255,255,0.18);
  --lg-border-strong: rgba(255,255,255,0.28);

  --lg-surface: rgba(255,255,255,0.06);
  --lg-surface-strong: rgba(255,255,255,0.10);

  /* True glass (slightly darker) */
  --lg-glass-tint: rgba(10,12,20,0.35);

  --lg-chip-bg: rgba(255,255,255,0.08);
  --lg-input-bg: rgba(0,0,0,0.34);

  --lg-table-bg: rgba(255,255,255,0.06);
  --lg-row-hover: rgba(255,255,255,0.06);

  --lg-divider: rgba(255,255,255,0.12);
}

/* -----------------------------
   3) Theme Tokens — Light
------------------------------ */
html[data-theme="light"]{
  --lg-txt: rgba(15,23,42,0.94);
  --lg-muted: rgba(15,23,42,0.64);

  --lg-border: rgba(15,23,42,0.10);
  --lg-border-strong: rgba(15,23,42,0.18);

  --lg-surface: rgba(255,255,255,0.70);
  --lg-surface-strong: rgba(255,255,255,0.86);

  /* True frosted glass */
  --lg-glass-tint: rgba(255,255,255,0.42);

  --lg-chip-bg: rgba(2,6,23,0.06);
  --lg-input-bg: rgba(255,255,255,0.85);

  --lg-table-bg: rgba(255,255,255,0.62);
  --lg-row-hover: rgba(2,6,23,0.05);

  --lg-divider: rgba(2,6,23,0.10);
}

/* -----------------------------
   4) Text colors
------------------------------ */
[data-testid="stAppViewContainer"]{ color: var(--lg-txt) !important; }
[data-testid="stAppViewContainer"] p,
[data-testid="stAppViewContainer"] label,
[data-testid="stAppViewContainer"] .stCaption{ color: var(--lg-muted) !important; }
[data-testid="stAppViewContainer"] h1,
[data-testid="stAppViewContainer"] h2,
[data-testid="stAppViewContainer"] h3,
[data-testid="stAppViewContainer"] h4{ color: var(--lg-txt) !important; }

/* =========================================================
   5) ULTRA GLASS — Base Card
   Support both: .lg-card and .glass-card
   (content stays sharp with z-index layering)
   ========================================================= */

.lg-card,
.glass-card{
  position: relative;
  overflow: hidden;
  border-radius: var(--lg-radius-xl);
  border: 1px solid var(--lg-border);
  background: transparent;
  box-shadow: var(--lg-shadow);
}

/* main glass blur + tint layer */
.lg-card::before,
.glass-card::before{
  content:"";
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;

  background:
    linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04)),
    var(--lg-glass-tint);

  backdrop-filter:
    blur(calc(var(--lg-blur-base) + (var(--lg-blur-boost) * var(--bt-scroll-k))))
    saturate(var(--lg-sat))
    brightness(var(--lg-bright));
  -webkit-backdrop-filter:
    blur(calc(var(--lg-blur-base) + (var(--lg-blur-boost) * var(--bt-scroll-k))))
    saturate(var(--lg-sat))
    brightness(var(--lg-bright));
}

/* frosted border glow */
.lg-card::after,
.glass-card::after{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius: inherit;
  z-index:1;
  pointer-events:none;

  background:
    radial-gradient(900px 520px at 12% 10%, rgba(var(--a-cyan), calc(0.14 + 0.10 * var(--bt-scroll-k))), transparent 58%),
    radial-gradient(760px 560px at 92% 18%, rgba(var(--a-orange), calc(0.12 + 0.08 * var(--bt-scroll-k))), transparent 62%),
    radial-gradient(900px 620px at 50% 110%, rgba(var(--a-purple), calc(0.10 + 0.08 * var(--bt-scroll-k))), transparent 65%),
    linear-gradient(180deg, rgba(255,255,255,0.10), transparent 60%);
  opacity: .95;
}

/* reflection gloss layer (separate element via mask using another pseudo on inner wrapper) */
.lg-card .lg-reflect,
.glass-card .lg-reflect{ display:none; } /* just in case */

/* keep content above blur/glow */
.lg-card > *,
.glass-card > *{
  position: relative;
  z-index: 5;
}

/* optional luxury hover (ONLY when you add class hover-float) */
.lg-card.hover-float:hover,
.glass-card.hover-float:hover{
  box-shadow: var(--lg-shadow-hover);
  border-color: var(--lg-border-strong);
  filter: brightness(1.01);
}

/* =========================================================
   6) Streamlit wrappers as glass cards (global)
   These are the “real cards” in Streamlit pages.
   ========================================================= */
section[data-testid="stSidebar"],
div[data-testid="stExpander"],
div[data-testid="stAlert"],
div[data-testid="stVerticalBlockBorderWrapper"]{
  position: relative !important;
  overflow: hidden !important;

  border-radius: var(--lg-radius-xl) !important;
  border: 1px solid var(--lg-border) !important;

  background: transparent !important;
  box-shadow: var(--lg-shadow-soft) !important;
}

/* blur + tint layer */
section[data-testid="stSidebar"]::before,
div[data-testid="stExpander"]::before,
div[data-testid="stAlert"]::before,
div[data-testid="stVerticalBlockBorderWrapper"]::before{
  content:"";
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;

  background:
    linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04)),
    var(--lg-glass-tint);

  backdrop-filter:
    blur(calc(var(--lg-blur-base) + (var(--lg-blur-boost) * var(--bt-scroll-k))))
    saturate(var(--lg-sat))
    brightness(var(--lg-bright));
  -webkit-backdrop-filter:
    blur(calc(var(--lg-blur-base) + (var(--lg-blur-boost) * var(--bt-scroll-k))))
    saturate(var(--lg-sat))
    brightness(var(--lg-bright));
}

/* glow + reflection sweep */
section[data-testid="stSidebar"]::after,
div[data-testid="stExpander"]::after,
div[data-testid="stAlert"]::after,
div[data-testid="stVerticalBlockBorderWrapper"]::after{
  content:"";
  position:absolute;
  inset:-40%;
  z-index:1;
  pointer-events:none;

  background:
    radial-gradient(900px 520px at 12% 10%, rgba(var(--a-cyan), calc(0.12 + 0.08 * var(--bt-scroll-k))), transparent 58%),
    radial-gradient(760px 560px at 92% 18%, rgba(var(--a-orange), calc(0.10 + 0.07 * var(--bt-scroll-k))), transparent 62%),
    linear-gradient(120deg, transparent 0%, rgba(255,255,255,0.16) 18%, transparent 38%, transparent 100%);

  transform: translateX(calc(-22% + 44% * var(--bt-scroll-k))) rotate(12deg);
  opacity: calc(0.62 + 0.28 * var(--bt-scroll-k));
  mix-blend-mode: screen;
  filter: blur(.6px);
}

/* keep inner content sharp */
section[data-testid="stSidebar"] > *,
div[data-testid="stExpander"] > *,
div[data-testid="stAlert"] > *,
div[data-testid="stVerticalBlockBorderWrapper"] > *{
  position: relative !important;
  z-index: 5 !important;
}

/* =========================================================
   7) Buttons
========================================================= */
button{
  border-radius: 16px !important;
  font-weight: 800 !important;
  transition: transform .18s var(--lg-ease), box-shadow .18s var(--lg-ease), filter .18s var(--lg-ease);
}
button:hover{
  transform: translateY(-1px) scale(1.02);
  box-shadow: var(--lg-shadow-soft);
  filter: brightness(1.02);
}

/* primary */
button[kind="primary"]{
  box-shadow: var(--lg-shadow-soft) !important;
}
button[kind="primary"]:hover{
  box-shadow: var(--lg-shadow) !important;
}

/* =========================================================
   8) Inputs
========================================================= */
div[data-baseweb="input"] > div,
div[data-baseweb="select"] > div,
div[data-baseweb="textarea"] textarea{
  background: var(--lg-input-bg) !important;
  border: 1px solid var(--lg-border) !important;
  border-radius: 14px !important;
  box-shadow: none !important;
}

[data-testid="stAppViewContainer"] .stTextInput input:focus,
[data-testid="stAppViewContainer"] .stTextArea textarea:focus,
[data-testid="stAppViewContainer"] div[data-baseweb="select"] > div:focus-within{
  box-shadow: 0 0 0 6px var(--lg-focus), var(--lg-shadow-soft) !important;
  border-color: rgba(var(--a-cyan),0.44) !important;
}

/* =========================================================
   9) Tables / DataFrame / DataEditor
========================================================= */
div[data-testid="stDataFrame"],
div[data-testid="stDataEditor"]{
  border-radius: var(--lg-radius-xl) !important;
  border: 1px solid var(--lg-border) !important;
  overflow: hidden !important;
  background: var(--lg-table-bg) !important;
  box-shadow: var(--lg-shadow-soft) !important;
}
div[data-testid="stDataFrame"] > div,
div[data-testid="stDataEditor"] > div{ background: transparent !important; }
div[data-testid="stDataFrame"] *,
div[data-testid="stDataEditor"] *{ border-color: var(--lg-divider) !important; }

/* =========================================================
   10) macOS window style (traffic lights)
   Use: class="mac-window" on a glass-card (topbar already uses it)
========================================================= */
.mac-window{
  position: relative;
  padding-top: 34px !important;
}
.mac-window::before{
  content:"";
  position:absolute;
  top: 12px;
  left: 14px;
  width: 54px;
  height: 12px;
  border-radius: 99px;
  background:
    radial-gradient(circle at 10px 6px, rgba(255,95,86,.95) 0 4px, transparent 5px),
    radial-gradient(circle at 27px 6px, rgba(255,189,46,.95) 0 4px, transparent 5px),
    radial-gradient(circle at 44px 6px, rgba(39,201,63,.95) 0 4px, transparent 5px);
  opacity: .95;
  pointer-events:none;
  z-index: 8;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce){
  button:hover{ transform:none !important; }
}
