/* ============================================================
   Modern Glassmorphism Theme for Streamlit (Refined)
   - Clean & professional
   - Full Dark/Light support
   - Fixes: inputs, password eye, number spinner (+/-), grey panels
   - Safer typography (no global div coloring)
   ============================================================ */

:root {
  --radius-lg: 24px;
  --radius-md: 18px;
  --radius-sm: 14px;
  --radius-xs: 10px;

  --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.25);
  --shadow-medium: 0 12px 40px rgba(0, 0, 0, 0.18);
  --shadow-light: 0 6px 24px rgba(0, 0, 0, 0.12);
  --shadow-glow: 0 0 40px rgba(100, 150, 255, 0.3);

  --blur-heavy: 24px;
  --blur-medium: 18px;
  --blur-light: 12px;

  --transition-fast: 0.18s ease;
  --transition-medium: 0.28s ease;
  --transition-slow: 0.5s ease;

  --accent-blue: rgba(88, 153, 255, 0.8);

  /* Light */
  --bg-light:
    radial-gradient(circle at 20% 10%, rgba(114, 165, 255, 0.2) 0%, transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(255, 170, 210, 0.15) 0%, transparent 40%),
    linear-gradient(135deg, #f0f5ff 0%, #e8eeff 50%, #f8fbff 100%);

  --glass-light-primary: rgba(255, 255, 255, 0.72);
  --glass-light-secondary: rgba(255, 255, 255, 0.55);
  --glass-light-tertiary: rgba(255, 255, 255, 0.35);

  --border-light: rgba(0, 0, 0, 0.08);
  --border-light-strong: rgba(0, 0, 0, 0.15);

  --text-light-primary: rgba(0, 0, 0, 0.95);
  --text-light-secondary: rgba(0, 0, 0, 0.75);
  --text-light-tertiary: rgba(0, 0, 0, 0.55);
  --text-light-accent: #0066ff;

  --button-light-primary: linear-gradient(135deg, rgba(88, 153, 255, 0.92), rgba(125, 100, 255, 0.92));
  --button-light-hover: linear-gradient(135deg, rgba(100, 170, 255, 0.96), rgba(140, 120, 255, 0.96));

  /* Dark */
  --bg-dark:
    radial-gradient(circle at 20% 10%, rgba(88, 153, 255, 0.15) 0%, transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(255, 85, 170, 0.10) 0%, transparent 40%),
    linear-gradient(135deg, #0a0f1a 0%, #121828 50%, #0c1120 100%);

  --glass-dark-primary: rgba(255, 255, 255, 0.12);
  --glass-dark-secondary: rgba(255, 255, 255, 0.085);
  --glass-dark-tertiary: rgba(255, 255, 255, 0.055);

  --border-dark: rgba(255, 255, 255, 0.10);
  --border-dark-strong: rgba(255, 255, 255, 0.18);

  --text-dark-primary: rgba(255, 255, 255, 0.98);
  --text-dark-secondary: rgba(255, 255, 255, 0.78);
  --text-dark-tertiary: rgba(255, 255, 255, 0.58);
  --text-dark-accent: #5a9bff;

  --button-dark-primary: linear-gradient(135deg, rgba(88, 153, 255, 0.72), rgba(125, 100, 255, 0.72));
  --button-dark-hover: linear-gradient(135deg, rgba(100, 170, 255, 0.82), rgba(140, 120, 255, 0.82));

  /* Unified "glass field" tokens */
  --field-radius: 18px;

  /* ✅ base field colors will be overridden by theme below */
  --field-bg: rgba(255,255,255,0.06);
  --field-bg-focus: rgba(255,255,255,0.09);
  --field-border: rgba(255,255,255,0.14);
  --field-border-focus: rgba(88,153,255,0.55);
  --field-shadow: 0 10px 28px rgba(0,0,0,0.22);
  --field-shadow-focus: 0 0 0 3px rgba(88,153,255,0.18), 0 14px 34px rgba(0,0,0,0.25);

  /* ✅ spinner button tokens (theme-aware) */
  --spin-btn-bg: rgba(255,255,255,0.07);
  --spin-btn-bg-hover: rgba(255,255,255,0.12);
  --spin-btn-border: rgba(255,255,255,0.10);
}

/* Theme mapping */
html[data-theme="light"], body.light {
  --bg: var(--bg-light);
  --glass-primary: var(--glass-light-primary);
  --glass-secondary: var(--glass-light-secondary);
  --glass-tertiary: var(--glass-light-tertiary);
  --border: var(--border-light);
  --border-strong: var(--border-light-strong);
  --text-primary: var(--text-light-primary);
  --text-secondary: var(--text-light-secondary);
  --text-tertiary: var(--text-light-tertiary);
  --text-accent: var(--text-light-accent);
  --button-primary: var(--button-light-primary);
  --button-hover: var(--button-light-hover);

  /* ✅ field becomes readable in light */
  --field-bg: rgba(255,255,255,0.75);
  --field-bg-focus: rgba(255,255,255,0.92);
  --field-border: rgba(0,0,0,0.10);
  --field-border-focus: rgba(88,153,255,0.55);
  --field-shadow: 0 10px 24px rgba(0,0,0,0.10);
  --field-shadow-focus: 0 0 0 3px rgba(88,153,255,0.20), 0 14px 30px rgba(0,0,0,0.12);

  /* ✅ spinner buttons in light */
  --spin-btn-bg: rgba(0,0,0,0.05);
  --spin-btn-bg-hover: rgba(0,0,0,0.08);
  --spin-btn-border: rgba(0,0,0,0.10);
}

html[data-theme="dark"], body.dark {
  --bg: var(--bg-dark);
  --glass-primary: var(--glass-dark-primary);
  --glass-secondary: var(--glass-dark-secondary);
  --glass-tertiary: var(--glass-dark-tertiary);
  --border: var(--border-dark);
  --border-strong: var(--border-dark-strong);
  --text-primary: var(--text-dark-primary);
  --text-secondary: var(--text-dark-secondary);
  --text-tertiary: var(--text-dark-tertiary);
  --text-accent: var(--text-dark-accent);
  --button-primary: var(--button-dark-primary);
  --button-hover: var(--button-dark-hover);
}

/* default if no theme attr */
html:not([data-theme]) {
  --bg: var(--bg-dark);
  --glass-primary: var(--glass-dark-primary);
  --glass-secondary: var(--glass-dark-secondary);
  --glass-tertiary: var(--glass-dark-tertiary);
  --border: var(--border-dark);
  --border-strong: var(--border-dark-strong);
  --text-primary: var(--text-dark-primary);
  --text-secondary: var(--text-dark-secondary);
  --text-tertiary: var(--text-dark-tertiary);
  --text-accent: var(--text-dark-accent);
  --button-primary: var(--button-dark-primary);
  --button-hover: var(--button-dark-hover);
}

/* Base */
.stApp {
  background: var(--bg) !important;
  background-attachment: fixed !important;
  color: var(--text-primary) !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", sans-serif !important;
  transition: background var(--transition-medium) !important;
}

header[data-testid="stHeader"] {
  background: transparent !important;
  border-bottom: none !important;
}

footer {
  visibility: hidden !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* ✅ Reduce top spacing (move content up) */
.block-container {
  padding-top: 0.6rem !important;
  padding-left: 1.25rem !important;
  padding-right: 1.25rem !important;
  padding-bottom: 1.25rem !important;
  max-width: 100% !important;
}

/* Safer typography (NO global div coloring) */
h1, h2, h3, h4, h5, h6 {
  color: var(--text-primary) !important;
  font-weight: 750 !important;
  letter-spacing: -0.01em !important;
}
p { color: var(--text-secondary) !important; }
small, .stCaption, .stMarkdown small { color: var(--text-tertiary) !important; }

/* ============================================================
   ✅ Remove grey layers behind containers/expanders
   ============================================================ */
div[data-testid="stContainer"],
div[data-testid="stExpander"],
div[data-testid="stVerticalBlockBorderWrapper"],
div[data-testid="stHorizontalBlock"],
div[data-testid="stVerticalBlock"] {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}
div[data-testid="stVerticalBlockBorderWrapper"] > div,
div[data-testid="stContainer"] > div {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}
details, details > summary {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* ============================================================
   Sidebar (cleaner typography + compact)
   ============================================================ */
section[data-testid="stSidebar"] {
  background: var(--glass-primary) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius-lg) !important;
  box-shadow: var(--shadow-heavy) !important;
  backdrop-filter: blur(var(--blur-heavy)) saturate(1.4) !important;
  -webkit-backdrop-filter: blur(var(--blur-heavy)) saturate(1.4) !important;
  margin: 0.8rem !important;
  transition: all var(--transition-medium) !important;
}

section[data-testid="stSidebar"] > div {
  padding: 1.15rem 1.05rem !important;
  background: transparent !important;
}

section[data-testid="stSidebar"] * {
  font-size: 12.5px !important;
  line-height: 1.25 !important;
  color: var(--text-primary) !important;
}

section[data-testid="stSidebar"] h1,
section[data-testid="stSidebar"] h2,
section[data-testid="stSidebar"] h3 {
  font-size: 14px !important;
  margin: 0.35rem 0 0.55rem 0 !important;
  font-weight: 800 !important;
}

section[data-testid="stSidebar"] label {
  font-size: 12px !important;
  opacity: 0.86 !important;
}

/* ============================================================
   Glass Cards
   ✅ unify: glass-card + pure-glass-card same look
   ============================================================ */
.glass-card,
.pure-glass-card {
  background: var(--glass-secondary) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius-md) !important;
  box-shadow: var(--shadow-medium) !important;
  backdrop-filter: blur(var(--blur-medium)) saturate(1.3) !important;
  -webkit-backdrop-filter: blur(var(--blur-medium)) saturate(1.3) !important;
  padding: 1.6rem !important;
  margin-bottom: 1.2rem !important;
  transition: all var(--transition-medium) !important;
}
.glass-card:hover,
.pure-glass-card:hover {
  box-shadow: var(--shadow-heavy), var(--shadow-glow) !important;
  transform: translateY(-3px) !important;
  border-color: var(--border-strong) !important;
}

.glass-card-mini {
  background: var(--glass-tertiary) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius-sm) !important;
  box-shadow: var(--shadow-light) !important;
  backdrop-filter: blur(var(--blur-light)) saturate(1.2) !important;
  -webkit-backdrop-filter: blur(var(--blur-light)) saturate(1.2) !important;
  padding: 1.1rem !important;
  margin-bottom: 0.9rem !important;
}

/* ============================================================
   ✅ Inputs / Select / Textarea (FULL coverage)
   ============================================================ */
div[data-baseweb="input"],
div[data-baseweb="textarea"],
div[data-baseweb="select"],
div[data-baseweb="datepicker"] {
  border-radius: var(--field-radius) !important;
  overflow: hidden !important;
  background: var(--field-bg) !important;
  border: 1px solid var(--field-border) !important;
  box-shadow: var(--field-shadow) !important;
  backdrop-filter: blur(var(--blur-light)) saturate(1.15) !important;
  -webkit-backdrop-filter: blur(var(--blur-light)) saturate(1.15) !important;
  transition: all var(--transition-fast) !important;
}

div[data-baseweb="input"] > div,
div[data-baseweb="textarea"] > div,
div[data-baseweb="select"] > div,
div[data-baseweb="datepicker"] > div {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: var(--field-radius) !important;
}

div[data-baseweb="input"]:focus-within,
div[data-baseweb="textarea"]:focus-within,
div[data-baseweb="select"]:focus-within,
div[data-baseweb="datepicker"]:focus-within {
  border-color: var(--field-border-focus) !important;
  box-shadow: var(--field-shadow-focus) !important;
  background: var(--field-bg-focus) !important;
}

/* Text inside inputs */
div[data-baseweb="input"] input,
div[data-baseweb="textarea"] textarea {
  color: var(--text-primary) !important;
  background: transparent !important;
  border: none !important;
  outline: none !important;
}

/* Placeholder */
div[data-baseweb="input"] input::placeholder,
div[data-baseweb="textarea"] textarea::placeholder {
  color: var(--text-tertiary) !important;
  opacity: 0.85 !important;
}

/* Password eye / enhancers */
div[data-baseweb="input"] [data-baseweb="end-enhancer"],
div[data-baseweb="input"] [data-baseweb="start-enhancer"] {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Labels */
label, .stTextInput label, .stSelectbox label, .stTextArea label {
  color: var(--text-secondary) !important;
  font-weight: 650 !important;
  margin-bottom: 0.35rem !important;
}

/* ============================================================
   ✅ Number input spinner (+ / -) — FIXED: ONE unified box
   ============================================================ */
div[data-baseweb="spinner"]{
  border-radius: var(--field-radius) !important;
  overflow: hidden !important;
  background: var(--field-bg) !important;
  border: 1px solid var(--field-border) !important;
  box-shadow: var(--field-shadow) !important;
  backdrop-filter: blur(var(--blur-light)) saturate(1.15) !important;
  -webkit-backdrop-filter: blur(var(--blur-light)) saturate(1.15) !important;
  transition: all var(--transition-fast) !important;
}

/* ✅ force internal layout to be a single row */
div[data-baseweb="spinner"] > div{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;

  display: flex !important;
  align-items: center !important;
  gap: 0 !important;               /* ✅ no separation */
  padding: 6px !important;         /* ✅ inner padding instead of button margin */
}

/* ✅ input grows and stays centered */
div[data-baseweb="spinner"] input{
  flex: 1 1 auto !important;
  min-width: 0 !important;
  background: transparent !important;
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  color: var(--text-primary) !important;
  font-weight: 700 !important;
  text-align: left !important;
}

/* ✅ buttons are part of the same box (NO margin) */
div[data-baseweb="spinner"] button{
  flex: 0 0 auto !important;

  background: var(--spin-btn-bg) !important;
  border: 1px solid var(--spin-btn-border) !important;
  color: var(--text-primary) !important;

  border-radius: 12px !important;
  margin: 0 !important;            /* ✅ CRITICAL: removed */
  min-width: 44px !important;
  min-height: 38px !important;

  transition: all var(--transition-fast) !important;
}

/* ✅ keep spacing by padding on wrapper (not margin) */
div[data-baseweb="spinner"] button + button{
  margin-left: 6px !important;     /* ✅ small gap only between - and + if needed */
}

div[data-baseweb="spinner"] button:hover{
  background: var(--spin-btn-bg-hover) !important;
  transform: translateY(-1px) !important;
}
div[data-baseweb="spinner"] button:active{
  transform: translateY(0) !important;
  background: var(--spin-btn-bg) !important;
}

/* remove separators if present */
div[data-baseweb="spinner"] [role="separator"],
div[data-baseweb="spinner"] hr{
  display: none !important;
}

div[data-baseweb="spinner"]:focus-within{
  border-color: var(--field-border-focus) !important;
  box-shadow: var(--field-shadow-focus) !important;
  background: var(--field-bg-focus) !important;
}

/* Sidebar fields spacing */
section[data-testid="stSidebar"] div[data-baseweb="input"],
section[data-testid="stSidebar"] div[data-baseweb="textarea"],
section[data-testid="stSidebar"] div[data-baseweb="select"],
section[data-testid="stSidebar"] div[data-baseweb="spinner"]{
  margin: 0.30rem 0 !important;
}

/* ============================================================
   Dropdown menus
   ============================================================ */
ul[role="listbox"] {
  background: var(--glass-secondary) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius-sm) !important;
  box-shadow: var(--shadow-heavy) !important;
  backdrop-filter: blur(var(--blur-medium)) saturate(1.3) !important;
  -webkit-backdrop-filter: blur(var(--blur-medium)) saturate(1.3) !important;
  overflow: hidden !important;
  margin-top: 0.5rem !important;
}
ul[role="listbox"] li {
  color: var(--text-primary) !important;
  padding: 0.70rem 1rem !important;
  transition: background-color var(--transition-fast) !important;
}
ul[role="listbox"] li:hover {
  background: rgba(127, 127, 127, 0.15) !important;
}
ul[role="listbox"] li[aria-selected="true"] {
  background: rgba(127, 127, 127, 0.25) !important;
}

/* Multiselect tags */
div[data-baseweb="tag"] {
  background: rgba(127, 127, 127, 0.20) !important;
  border: 1px solid var(--border) !important;
  border-radius: 999px !important;
  padding: 0.20rem 0.70rem !important;
  margin: 0.25rem !important;
}
div[data-baseweb="tag"] span { color: var(--text-primary) !important; }

/* ============================================================
   Buttons
   ============================================================ */
.stButton > button {
  border-radius: var(--radius-sm) !important;
  border: none !important;
  background: var(--button-primary) !important;
  color: white !important;
  font-weight: 700 !important;
  padding: 0.72rem 1.6rem !important;
  transition: all var(--transition-fast) !important;
  box-shadow: var(--shadow-light) !important;
  white-space: nowrap !important;
}
.stButton > button:hover {
  background: var(--button-hover) !important;
  transform: translateY(-2px) !important;
  box-shadow: var(--shadow-medium) !important;
}
.stButton > button:active { transform: translateY(0) !important; }
.stButton > button:focus {
  outline: none !important;
  box-shadow: 0 0 0 3px rgba(88, 153, 255, 0.38) !important;
}

/* Secondary buttons */
.stButton > button[kind="secondary"],
.stButton > button[data-testid="baseButton-secondary"] {
  background: var(--glass-tertiary) !important;
  color: var(--text-primary) !important;
  border: 1px solid var(--border) !important;
}

/* Sidebar buttons */
section[data-testid="stSidebar"] .stButton > button{
  width: 100% !important;
  min-height: 2.35rem !important;
  padding: 0.45rem 0.90rem !important;
}

/* ============================================================
   Tables (basic)
   ============================================================ */
.stTable {
  background: var(--glass-tertiary) !important;
  border-radius: var(--radius-sm) !important;
  border: 1px solid var(--border) !important;
  backdrop-filter: blur(var(--blur-light)) saturate(1.2) !important;
  -webkit-backdrop-filter: blur(var(--blur-light)) saturate(1.2) !important;
}

/* ============================================================
   Tabs
   ============================================================ */
.stTabs [data-baseweb="tab-list"] {
  background: var(--glass-tertiary) !important;
  border-radius: var(--radius-sm) !important;
  padding: 0.45rem !important;
  gap: 0.45rem !important;
}
.stTabs [data-baseweb="tab"] {
  background: transparent !important;
  color: var(--text-secondary) !important;
  border-radius: var(--radius-xs) !important;
  padding: 0.70rem 1.35rem !important;
  transition: all var(--transition-fast) !important;
}
.stTabs [aria-selected="true"] {
  background: var(--button-primary) !important;
  color: white !important;
  box-shadow: var(--shadow-light) !important;
}

/* ============================================================
   Centered Frame (Home/Tool pages)
   ============================================================ */
.page-center{
  min-height: calc(100vh - 6rem);
  display: flex;
  align-items: center;
  justify-content: center;
}
.page-frame{
  width: min(1100px, 94vw);
  padding: 28px 28px 22px 28px;

  border-radius: 20px;
  border: 1px solid rgba(255,255,255,0.18);

  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(16px) saturate(1.15);
  -webkit-backdrop-filter: blur(16px) saturate(1.15);

  box-shadow:
    0 0 0 1px rgba(255,255,255,0.06),
    0 18px 45px rgba(0,0,0,0.55),
    0 0 32px rgba(90,140,255,0.15);
}

/* ============================================================
   Responsive
   ============================================================ */
@media (max-width: 768px) {
  :root {
    --radius-lg: 20px;
    --radius-md: 16px;
    --radius-sm: 12px;
    --blur-heavy: 20px;
    --blur-medium: 16px;
    --blur-light: 10px;
  }

  .block-container {
    padding: 0.9rem !important;
  }

  section[data-testid="stSidebar"] {
    margin: 0.5rem !important;
  }
}

@media (min-width: 1200px) {
  .block-container {
    max-width: 1400px !important;
    margin: 0 auto !important;
  }
}
